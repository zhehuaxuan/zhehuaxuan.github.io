<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="知足.感恩.幸运">
<meta property="og:type" content="website">
<meta property="og:title" content="zhehua&#39;s note">
<meta property="og:url" content="https://zhehuaxuan.github.io/index.html">
<meta property="og:site_name" content="zhehua&#39;s note">
<meta property="og:description" content="知足.感恩.幸运">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="zhehua&#39;s note">
<meta name="twitter:description" content="知足.感恩.幸运">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zhehuaxuan.github.io/"/>





  <title>zhehua's note</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zhehua's note</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            时光
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-works">
          <a href="/works/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />
            
            作品
          </a>
        </li>
      
        
        <li class="menu-item menu-item-nav">
          <a href="/nav/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-send"></i> <br />
            
            站点
          </a>
        </li>
      
        
        <li class="menu-item menu-item-think">
          <a href="/think/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-grav"></i> <br />
            
            随想
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhehuaxuan.github.io/2019/02/13/translation/CSSOM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZheHuaXuan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhehua's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/13/translation/CSSOM/" itemprop="url">CSS对象模型（CSSOM）指南</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-13T23:43:23+08:00">
                2019-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CSS/" itemprop="url" rel="index">
                    <span itemprop="name">CSS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>作者：<a href="https://css-tricks.com/author/lazaris/" target="_blank" rel="noopener">Louis Lazaris</a></p>
<p>原文链接：<a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/" target="_blank" rel="noopener">https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/</a></p>
</blockquote>
<p>如果您已经编写了一段时间的JavaScript，那么可以肯定您使用过一些用于处理<strong>文档对象模型（DOM）</strong>的脚本。DOM脚本利用网页提供的一组API（或接口）来操作和处理页面上的元素。</p>
<p>那么，您应该还熟悉另一个对象模型：CSS对象模型（CSSOM），可能你已经在无意识的时候使用过它。</p>
<p>在这篇文章中，我将介绍CSSOM的许多重要的功能，从最常见的开始，慢慢转向一些大家不清楚但很实用的小功能。</p>
<h3 id="什么是CSSOM"><a href="#什么是CSSOM" class="headerlink" title="#什么是CSSOM?"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-0" target="_blank" rel="noopener">#</a>什么是CSSOM?</h3><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CSS_Object_Model" target="_blank" rel="noopener">根据MDN</a>:</p>
<blockquote>
<p>CSS对象模型是JavaScript处理CSS的API。它很像DOM，只是面向CSS而不是HTML。它允许用户动态地读取和修改CSS样式。 </p>
</blockquote>
<p>MDN的信息基于 <a href="https://drafts.csswg.org/cssom/" target="_blank" rel="noopener">官方的W3C CSSOM规范</a>. 用W3C文档来熟悉CSSOM的是一种低效的方式，也不适用于那些正在寻找一些实际编码示例的人。</p>
<p>使用MDN显然会好得多，虽然在某些方面仍然很缺乏。因此，对于这篇文章，我试图尽力的去创建有用的代码示例来演示，这样您就可以通过实际代码解除疑惑。</p>
<p>就像上面所说，文章从大多数前端开发人员熟悉的内容开始。里面有一些公有属性常常和DOM脚本混在一起，但是CSSOM的API还是占了很大一部分。</p>
<h3 id="使用element-style获取内联样式"><a href="#使用element-style获取内联样式" class="headerlink" title="#使用element.style获取内联样式"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-1" target="_blank" rel="noopener">#</a>使用element.style获取内联样式</h3><p>使用JavaScript操作和获取CSS属性和值的最基本方法是通过<code>style</code>对象或属性，这个对象和属性往往对于所有的HTML元素都适用。这里有一个例子： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.style.background = <span class="string">'lightblue'</span>;</span><br></pre></td></tr></table></figure>
<p>大多数人之前可能已经看过或用过这种语法。我可以使用<code>element.style.propertyName</code>.的格式为页面上的任何对象添加或更改CSS 。</p>
<p>在上述例子中，我正在将<code>background</code>属性的值更改为<code>lightblue</code>。当然，<code>background</code>是“短属性”（只有一个单词组成的属性）。如果我只想更改<code>background-color</code>属性怎么办？对于任何带连字符的属性，只需将属性名称转换为驼峰法的形式，如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.style.backgroundColor = <span class="string">'lightblue'</span>;</span><br></pre></td></tr></table></figure>
<p>在大多数情况下，“短属性”以小写单词的形式表示和访问，而连字符属性用驼峰法表示。但是有一个例外是使用<code>float</code>属性。因为<code>float</code>是JavaScript中的保留字，所以您需要使用<code>cssFloat</code>（如果您支持IE8及更早版本，请使用<code>styleFloat</code>）。这类似于HTML中的<code>for</code>属性，我们使用<code>htmlFor</code> 来表示。</p>
<p>下面是一个使用<code>style</code>属性来允许用户更改当前页面背景颜色的例子：</p>
<iframe height="665" style="width: 100%;" scrolling="no" title="GzWBxP" src="//codepen.io/zhehuaxuan/embed/GzWBxP/?height=265&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/GzWBxP/" target="_blank" rel="noopener">GzWBxP</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>我们使用JavaScript定义CSS属性和值虽然简单方法，但是使用<code>style</code>属性有一个很大的前提：<strong>只适用于元素的内联样式</strong>。</p>
<p>当您使用该<code>style</code>属性读取CSS 时，这一点变得清晰：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.style.backgroundColor = <span class="string">'lightblue'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">document</span>.body.style.backgroundColor);</span><br><span class="line"><span class="comment">// "lightblue"</span></span><br></pre></td></tr></table></figure>
<p>在上面的例子中，我在<code>&lt;body&gt;</code>元素上定义了一个内联样式，然后我将相同的样式输出到控制台。但是如果我尝试去读取<code>style</code>的另一个属性的值时，它将不返回任何内容 - 除非是我之前在CSS或JavaScript中定义的内联样式。例如： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">document</span>.body.style.color);</span><br><span class="line"><span class="comment">// Returns nothing if inline style doesn't exist</span></span><br></pre></td></tr></table></figure>
<p>即使我使用外部样式表的<code>color</code> 属性去修饰<code>&lt;body&gt;</code> 元素，也同样获取不到值，如下所示：</p>
<div class="cp_embed_wrapper resizable" style="height: 434px;"><iframe name="cp_embed_2" src="https://codepen.io/impressivewebs/embed/LXPewe?height=434&amp;theme-id=1&amp;slug-hash=LXPewe&amp;default-tab=result&amp;user=impressivewebs&amp;pen-title=element.style%20Reads%20Only%20Inline%20Styles&amp;name=cp_embed_2" scrolling="no" frameborder="0" height="434" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="element.style只读取内联样式" class="cp_embed_iframe " style="width: 100%; overflow: hidden; display: block; height: 100%;" id="cp_embed_LXPewe"></iframe><div class="win-size-grip" style="touch-action: none;"></div><div class="win-size-grip" style="touch-action: none;"></div><div class="win-size-grip" style="touch-action: none;"></div><div class="win-size-grip" style="touch-action: none;"></div></div>

<p>通过JavaScript使用<code>element.style</code>的方式去改变元素的属性是最简单和通用的方式，但是你也看到这里很明显有很大的限制，让我们继续来看一下JavaScript还有那些更好用的方式去读取和修改我们的样式。</p>
<h3 id="获取计算样式"><a href="#获取计算样式" class="headerlink" title="#获取计算样式"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-2" target="_blank" rel="noopener">#</a>获取计算样式</h3><p>您可以使用<code>window.getComputedStyle()</code> 方法来读取元素上的任何CSS属性：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.getComputedStyle(<span class="built_in">document</span>.body).background;</span><br><span class="line"><span class="comment">// "rgba(0, 0, 0, 0) none repeat scroll 0% 0% / auto padding-box border-box"</span></span><br></pre></td></tr></table></figure>
<p>哇，真实一个有意思的结果。在某种程度上，<code>window.getComputedStyle()</code>是<code>style</code>的孪生兄弟。如果直接使用<code>style</code>属性给你提供的元素实际样式信息太少，那么使用<code>window.getComputedStyle()</code>会给您一些启发。</p>
<iframe height="465" style="width: 100%;" scrolling="no" title="使用window.getComputedStyle" src="//codepen.io/zhehuaxuan/embed/NopOMB/?height=465&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true"></iframe>

<p>在上述示例中，<code>&lt;body&gt;</code>元素的<code>background</code>属性是使用<code>background: papayawhip;</code>定义。但<code>getComputedStyle()</code>方法返回<code>background</code>属性中的所有值，未在CSS中明确定义的那些将返回这个属性的初始（或默认）值。</p>
<p>这意味着，对于任何属性，即使CSS中没有定义它们，使用<code>window.getComputedStyle()</code>仍可以返回所有初始值： </p>
<iframe height="465" style="width: 100%;" scrolling="no" title="window.getComputedStyle()输出初始属性" src="//codepen.io/zhehuaxuan/embed/aXJRXN/?height=465&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true"></iframe>

<p>类似地，比如<code>width</code>和<code>height</code>这样的属性，不管这些值是否在CSS中的任何位置定义，它将显示元素对应属性的计算值，如下面的示例所示： </p>
<iframe height="465" style="width: 100%;" scrolling="no" title="计算元素的width和height" src="//codepen.io/zhehuaxuan/embed/PVpyra/?height=465&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true"></iframe>

<p>尝试调整上面示例中的父元素大小以查看结果。这类似于读取<code>window.innerWidth</code>值，只是在这边是去获取指定元素上指定属性的CSS值，而不仅仅是一般的窗口或视口。</p>
<p>这里我们使用<code>window.getComputedStyle()</code>方法中的几种方式来访问。我已经演示了其中的一种方法，它使用<strong>点符号+驼峰式属性名称</strong>的方式添加到方法的末尾。您可以在以下代码中看到三种不同的方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dot notation, same as above</span></span><br><span class="line"><span class="built_in">window</span>.getComputedStyle(el).backgroundColor;</span><br><span class="line"></span><br><span class="line"><span class="comment">// square bracket notation</span></span><br><span class="line"><span class="built_in">window</span>.getComputedStyle(el)[<span class="string">'background-color'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// using getPropertyValue()</span></span><br><span class="line"><span class="built_in">window</span>.getComputedStyle(el).getPropertyValue(<span class="string">'background-color'</span>);</span><br></pre></td></tr></table></figure>
<p>上面第一种方法的形式和先前的那个例子一样。</p>
<p>第二种方式使用中括号将CSS属性用单引号包裹起来，这种方式不推荐，代码编译器会告警。</p>
<p>第三种使用<code>getPropertyValue()</code> 的方式。</p>
<p>在第一个例子中，我们使用骆驼法（在这个例子中，<code>float</code>和<code>cssFloat</code>属性都可以工作），而接下来的两个方法使用相同的语法形式，使用CSS中的属性（连字符，通常被称为“烤肉箱”）。</p>
<p>下面的示例与前一个相同，但这次使用<code>getPropertyValue()</code>访问两个元素的宽度：</p>
<p></p><p class="codepen" data-height="465" data-theme-id="dark" data-default-tab="html,result" data-user="zhehuaxuan" data-slug-hash="pGeQOy" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1em 0; padding: 1em;" data-pen-title="pGeQOy"><br>  <span>See the Pen <a href="https://codepen.io/zhehuaxuan/pen/pGeQOy/" target="_blank" rel="noopener"><br>  pGeQOy</a> by 宣浙华 (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>)<br>  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span><br></p><p></p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

<h3 id="获取伪元素的计算样式"><a href="#获取伪元素的计算样式" class="headerlink" title="#获取伪元素的计算样式"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-3" target="_blank" rel="noopener">#</a>获取伪元素的计算样式</h3><p>一个鲜为人知的事情就是<code>window.getComputedStyle()</code>能够获取伪元素的样式信息。你可以看到 <code>window.getComputedStyle()</code> 方法像如下形式的声明。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.getComputedStyle(<span class="built_in">document</span>.body, <span class="literal">null</span>).width;</span><br></pre></td></tr></table></figure>
<p>请注意第二个参数, <code>null</code>, Firefox的版本4之前的需要第二个参数，这就是为什么你经常在老代码中看到它（目前所有的浏览器都不需要这个参数）。</p>
<p>第二个参数可选，允许我们去获得当前元素的伪元素的属性，如下所示：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.box::before &#123;</span><br><span class="line">  content: 'Example';</span><br><span class="line">  display: block;</span><br><span class="line">  width: 50px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这里，我们给<code>.box</code> 元素添加了一个<code>::before</code> 的伪元素，下面的JavaScript代码用于计算伪元素的属性值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> box = <span class="built_in">document</span>.querySelector(<span class="string">'.box'</span>);</span><br><span class="line"><span class="built_in">window</span>.getComputedStyle(box, <span class="string">'::before'</span>).width;</span><br><span class="line"><span class="comment">// "50px"</span></span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="getComputedStyle() to get styles from a pseudo-element" src="//codepen.io/zhehuaxuan/embed/XOMOoJ/?height=265&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/XOMOoJ/" target="_blank" rel="noopener">getComputedStyle() to get styles from a pseudo-element</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>您也可以为其他伪元素执行此操作<code>::first-line</code>，如以下代码和演示： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="built_in">document</span>.querySelector(<span class="string">'.box p'</span>);</span><br><span class="line"><span class="built_in">window</span>.getComputedStyle(p, <span class="string">'::first-line'</span>).color;</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="getComputedStyle() to get styles from a pseudo-element first-line" src="//codepen.io/zhehuaxuan/embed/vbxbMe/?height=265&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/vbxbMe/" target="_blank" rel="noopener">getComputedStyle() to get styles from a pseudo-element first-line</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>And here’s another example using the <code>::placeholder</code> pseudo-element, which apples to <code>&lt;input&gt;</code>elements:</p>
<p>这里有另外一个例子使用使用input标签中的<code>::placeholder</code>伪元素，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> input = <span class="built_in">document</span>.querySelector(<span class="string">'input'</span>);</span><br><span class="line"><span class="built_in">window</span>.getComputedStyle(input, <span class="string">'::placeholder'</span>).color</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="getComputedStyle() to get styles from a ::placeholder" src="//codepen.io/zhehuaxuan/embed/GzWzVx/?height=265&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/GzWzVx/" target="_blank" rel="noopener">getComputedStyle() to get styles from a ::placeholder</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<blockquote>
<p>以上工作在最新的Firefox中，但不适用于Chrome或Edge（我已经为Chrome 提交了错误报告）。</p>
</blockquote>
<p>还应该注意的是，尝试访问不存在（但有效）的伪元素的样式时，浏览器会有不同的结果（<code>::banana</code>伪元素）。您可以使用以下演示在各种浏览器中查看效果： </p>
<iframe height="465" style="width: 100%;" scrolling="no" title="Testing getComputedStyle() on non-existent pseudo-elements" src="//codepen.io/zhehuaxuan/embed/VgpRer/?height=265&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/VgpRer/" target="_blank" rel="noopener">Testing getComputedStyle() on non-existent pseudo-elements</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>作为本节的一个小点，有一个名为Firefox的方法<a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/getDefaultComputedStyle" target="_blank" rel="noopener"><code>getDefaultComputedStyle()</code></a>，它不是规范的一部分，可能永远不会。 </p>
<h3 id="CSSStyleDeclaration-API"><a href="#CSSStyleDeclaration-API" class="headerlink" title="#CSSStyleDeclaration API"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-4" target="_blank" rel="noopener">#</a>CSSStyleDeclaration API</h3><p>早些时候，当我向您展示如何通过<code>style</code>对象或使用<code>getComputedStyle()</code>访问属性，在这两种情况下，这些技术都暴露了<code>CSSStyleDeclaration</code>接口。</p>
<p>换句话说，以下两行都将返回<code>CSSStyleDeclaration</code>文档<code>body</code>元素上的对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.style;</span><br><span class="line"><span class="built_in">window</span>.getComputedStyle(<span class="built_in">document</span>.body);</span><br></pre></td></tr></table></figure>
<p>下面是这两个对象返回的快照：</p>
<p><img src="https://css-tricks.com/wp-content/uploads/2018/11/cssstyledeclaration-api.png" alt="The CSSStyleDeclaration API in the DevTools console"></p>
<p><code>getComputedStyle()</code>函数返回的值是只读的，使用<code>element.style</code>，获取和设置属性是可以的，但是就像先前提到的，<strong>这些只会影响document的内联样式</strong>。</p>
<h3 id="setProperty-getPropertyValue-和item"><a href="#setProperty-getPropertyValue-和item" class="headerlink" title="#setProperty(), getPropertyValue(), 和item()"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-5" target="_blank" rel="noopener">#</a>setProperty(), getPropertyValue(), 和item()</h3><p>一旦您以上述方式之一暴露了<code>CSSStyleDeclaration</code>对象，您就可以访问许多有用的方法来读取或操作这些值。同样，<code>getComputedStyle()返回的</code>值是只读的，但是当通过<code>style</code>属性使用时，某些方法可用于获取和设置。</p>
<p>请考虑以下代码和演示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> box = <span class="built_in">document</span>.querySelector(<span class="string">'.box'</span>);</span><br><span class="line"></span><br><span class="line">box.style.setProperty(<span class="string">'color'</span>, <span class="string">'orange'</span>);</span><br><span class="line">box.style.setProperty(<span class="string">'font-family'</span>, <span class="string">'Georgia, serif'</span>);</span><br><span class="line">op.innerHTML = box.style.getPropertyValue(<span class="string">'color'</span>);</span><br><span class="line">op2.innerHTML = <span class="string">`<span class="subst">$&#123;box.style.item(<span class="number">0</span>)&#125;</span>, <span class="subst">$&#123;box.style.item(<span class="number">1</span>)&#125;</span>`</span>;</span><br></pre></td></tr></table></figure>
<iframe height="265" style="width: 100%;" scrolling="no" title="Using three different methods of the CSSStyleDeclaration API" src="//codepen.io/zhehuaxuan/embed/JxWzyy/?height=265&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/JxWzyy/" target="_blank" rel="noopener">Using three different methods of the CSSStyleDeclaration API</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>在这个例子中，我使用了三种不同的<code>style</code>对象方法： </p>
<ul>
<li><code>setProperty()</code>方法。这需要两个参数，每个参数都是一个字符串：属性（以常规CSS表示法）和属性值</li>
<li><code>getPropertyValue()</code>方法。这需要一个参数，你想要获得的属性。和前面提到的<code>getComputedStyle()</code>方法一样，返回 <code>CSSStyleDeclaration</code> 对象。</li>
<li><code>item()</code>方法。这需要使用一个参数，这需要一个参数，它是一个正整数，表示您要访问的属性的索引。返回值是该索引处的属性名称。</li>
</ul>
<p>注意，在我上面的简单示例中，只有两个样式添加到元素的内联CSS中。这意味着如果我要访问<code>item(2)</code>，返回值将是一个空字符串。如果我<code>getPropertyValue()</code>以前访问未在该元素的内联样式中设置的属性，也会得到相同的结果。 </p>
<h3 id="使用removeProperty"><a href="#使用removeProperty" class="headerlink" title="# 使用removeProperty()"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-6" target="_blank" rel="noopener">#</a> 使用removeProperty()</h3><p>In addition to the three methods mentioned above, there are two others exposed on a <code>CSSStyleDeclaration</code> object. In the following code and demo, I’m using the <code>removeProperty()</code>method:</p>
<p>除了上面提到的三种方法之外，还有另外两种方法暴露在一个<code>CSSStyleDeclaration</code>物体上。在下面的代码和示例中，我将使用<code>removeProperty()</code>方法： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">box.style.setProperty(<span class="string">'font-size'</span>, <span class="string">'1.5em'</span>);</span><br><span class="line">box.style.item(<span class="number">0</span>) <span class="comment">// "font-size"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.style.removeProperty(<span class="string">'font-size'</span>);</span><br><span class="line"><span class="built_in">document</span>.body.style.item(<span class="number">0</span>); <span class="comment">// ""</span></span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Using the removeProperty() method of the CSSStyleDeclaration API" src="//codepen.io/zhehuaxuan/embed/wNJOEV/?height=265&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/wNJOEV/" target="_blank" rel="noopener">Using the removeProperty() method of the CSSStyleDeclaration API</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>In this case, after I set <code>font-size</code> using <code>setProperty()</code>, I log the property name to ensure it’s there. The demo then includes a button that, when clicked, will remove the property using <code>removeProperty()</code>.</p>
<p>在这种例子中，在我使用<code>setProperty()</code>设置<code>font-size</code>，我记录属性名称，然后使用一个按钮，单击该按钮使用<code>removeProperty()</code>删除该属性。 </p>
<h3 id="获取和设置属性的优先级"><a href="#获取和设置属性的优先级" class="headerlink" title="#获取和设置属性的优先级"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-7" target="_blank" rel="noopener">#</a>获取和设置属性的优先级</h3><p>最后，这是我在写这篇文章的时候发现了一个有趣的特性：使用<code>getPropertyPriority()</code>，看下面CodePen演示的示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">box.style.setProperty(<span class="string">'font-family'</span>, <span class="string">'Georgia, serif'</span>, <span class="string">'important'</span>);</span><br><span class="line">box.style.setProperty(<span class="string">'font-size'</span>, <span class="string">'1.5em'</span>);</span><br><span class="line"></span><br><span class="line">box.style.getPropertyPriority(<span class="string">'font-family'</span>); <span class="comment">// important</span></span><br><span class="line">op2.innerHTML = box.style.getPropertyPriority(<span class="string">'font-size'</span>); <span class="comment">// ""</span></span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Using getPropertyPriority() to get a property&apos;s &amp;quot;importance&amp;quot;" src="//codepen.io/zhehuaxuan/embed/wNJOLv/?height=265&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/wNJOLv/" target="_blank" rel="noopener">Using getPropertyPriority() to get a property&apos;s &amp;quot;importance&amp;quot;</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>在该代码的第一行，您可以看到我使用<code>setProperty()</code>方法，就像我之前一样。但是，我们在这里包含了第三个参数。第三个参数是一个可选字符串，用于定义是否希望该属性附加<code>!important</code>关键字。</p>
<p>在我为属性设置<code>!important</code>之后，我们使用<code>getPropertyPriority()</code>方法检查该属性的优先级。如果您觉得该属性不重要，可以省略第三个参数，使用关键字<code>undefined</code>，或将第三个参数包含为空字符串。</p>
<p>我应该在这里强调，这些方法可以与已经直接放在HTML元素<code>style</code>属性上的任何内联样式一起使用。</p>
<p>所以，如果我有如下HTML：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">style</span>=<span class="string">"border: solid 1px red !important;"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>我可以使用本节中讨论的任何方法来读取或修改该样式。这里应该注意的是，由于我使用了这种内联样式的简写属性并将其设置为<code>!important</code>，因此我们使用<code>getPropertyPriority()</code>就可以把长属性的<code>important</code>返回出来，请参阅下面的代码和演示： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// These all return "important"</span></span><br><span class="line">box.style.getPropertyPriority(<span class="string">'border'</span>));</span><br><span class="line">box.style.getPropertyPriority(<span class="string">'border-top-width'</span>));</span><br><span class="line">box.style.getPropertyPriority(<span class="string">'border-bottom-width'</span>));</span><br><span class="line">box.style.getPropertyPriority(<span class="string">'border-color'</span>));</span><br><span class="line">box.style.getPropertyPriority(<span class="string">'border-style'</span>));</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Using getPropertyPriority() to check the priority of longhand properties" src="//codepen.io/zhehuaxuan/embed/xMqeZz/?height=265&theme-id=dark&default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/xMqeZz/" target="_blank" rel="noopener">Using getPropertyPriority() to check the priority of longhand properties</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>在这个例子中，即使我只在<code>border</code>属性中显式设置了<code>style</code>属性，所有关联<code>border</code>的longhand属性也都返回<code>important</code>。 </p>
<h3 id="CSSStyleSheet-Interface"><a href="#CSSStyleSheet-Interface" class="headerlink" title="# CSSStyleSheet Interface"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-8" target="_blank" rel="noopener">#</a> CSSStyleSheet Interface</h3><p>到目前为止，我所考虑的方法都涉及内联样式（通常不那么有用）和计算样式（这些方式很有用，但通常过于具体）。</p>
<p>还有一个更有用的API，允许您获取具有可读写性的样式表，而不仅仅是内联样式，这就是<code>CSSStyleSheet</code>。从文档样式表访问文档属性的最简单方法是使用<code>styleSheets</code>属性。这就是<code>CSSStyleSheet接口</code>。</p>
<p>例如，下面的使用该<code>length</code>属性来查看当前文档具有多少样式表：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.styleSheets.length; <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p>我可以使用从零开始的索引来引用任何文档的样式表： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.styleSheets[<span class="number">0</span>];</span><br></pre></td></tr></table></figure>
<p>如果我们用console打印stylesheet ，我们将会看到下面的这些方法和属性：</p>
<p><img src="https://css-tricks.com/wp-content/uploads/2018/11/docstylesheet.png" alt="The CSSStyleSheet Interface in the DevTools Console"></p>
<p>这里最有用的属性是<code>cssRules</code>。此属性提供样式表中包含的所有CSS规则（包括声明块，规则，媒体规则等）。在下面，我将详细介绍如何利用此API来操作和读取外部样式表中的样式。 </p>
<h3 id="使用Stylesheet-对象"><a href="#使用Stylesheet-对象" class="headerlink" title="#使用Stylesheet 对象"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-9" target="_blank" rel="noopener">#</a>使用Stylesheet 对象</h3><p>为了简单起见，让我们使用外部样式表，其中只包含少量规则。这里请允许我演示如何使用CSSOM访问样式表的不同部分，和DOM脚本的方式类似。</p>
<p>这是我使用下面的样式表：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: Helvetica, Arial, sans-serif;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">2em</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.4</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">main</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1024px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.component</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: right;</span><br><span class="line">  <span class="attribute">border-left</span>: solid <span class="number">1px</span> <span class="number">#444</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">media</span> (max-width: <span class="number">800px</span>) &#123;</span><br><span class="line">  <span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.2</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.component</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: none;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: lightgreen;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">keyframes</span> exampleAnimation &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: blue;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  20% &#123;</span><br><span class="line">    <span class="attribute">color</span>: orange;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: green;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">code</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: firebrick;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我可以在这个例子中尝试很多事情，首先，我将循环遍历样式表中的所有样式规则，并记录每个样式的选择器的值： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myRules = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules,</span><br><span class="line">    p = <span class="built_in">document</span>.querySelector(<span class="string">'p'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">of</span> myRules) &#123;</span><br><span class="line">  <span class="keyword">if</span> (i.type === <span class="number">1</span>) &#123;</span><br><span class="line">    p.innerHTML += <span class="string">`&lt;code&gt;<span class="subst">$&#123;i.selectorText&#125;</span>&lt;/code&gt;&lt;br&gt;`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="davLKB" src="//codepen.io/zhehuaxuan/embed/davLKB/?height=465&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/davLKB/" target="_blank" rel="noopener">davLKB</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>在上面的示例中需要注意的几件事情。首先，我缓存记录外部样式表的<code>cssRules</code>对象的引用。然后我遍历该对象中的所有规则，检查每个规则的类型。</p>
<p>在这种情况下，我想要类型的规则<code>1</code>，它代表<code>STYLE_RULE</code>常量。其他常量包括<code>IMPORT_RULE</code>（3），<code>MEDIA_RULE</code>（4），<code>KEYFRAMES_RULE</code>（7）等。您可以<a href="https://developer.mozilla.org/en-US/docs/Web/API/CSSRule#Type_constants" target="_blank" rel="noopener">在此MDN文章中</a>查看这些常量的完整表。</p>
<p>当我确认规则是样式规则时，我打印每个样式规则的<code>selectorText</code>属性。展示如下结果：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">*</span><br><span class="line">body</span><br><span class="line">main</span><br><span class="line">.component</span><br><span class="line">a:hover</span><br><span class="line">code</span><br></pre></td></tr></table></figure>
<p><code>selectorText</code>属性表示选择器样式规则的名称。这是一个可写属性，所以如果我用<code>for</code>使用以下代码更改原始循环内特定规则的选择器： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (i.selectorText === <span class="string">'a:hover'</span>) &#123;</span><br><span class="line">  i.selectorText = <span class="string">'a:hover, a:active'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Working with the CSSStyleSheet API – Changing the Selector Text" src="//codepen.io/zhehuaxuan/embed/yZMrmE/?height=265&theme-id=dark&default-tab=js,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/yZMrmE/" target="_blank" rel="noopener">Working with the CSSStyleSheet API – Changing the Selector Text</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>在这个例子中，我查询一个选择器（链接），把 <code>:hover</code> 属性查询出来，应用到 <code>:active</code> 中。而且，我可以使用字符串方法甚至是正则表达式来查找所有实例的<code>:hover</code>，然后从那里做一些事情。但这个例子已经足以证明它是工作原理了。 </p>
<h3 id="使用CSSOM访问-media规则"><a href="#使用CSSOM访问-media规则" class="headerlink" title="#使用CSSOM访问@media规则"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-10" target="_blank" rel="noopener">#</a>使用CSSOM访问@media规则</h3><p>您会注意到我的样式表还包括媒体查询规则：@keyframes at-rule。当我搜索样式规则（类型1）时，这两个都被跳过了。我们现在找到所有<code>@media</code>规则： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myRules = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules,</span><br><span class="line">    p = <span class="built_in">document</span>.querySelector(<span class="string">'.output'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">of</span> myRules) &#123;</span><br><span class="line">  <span class="keyword">if</span> (i.type === <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (j <span class="keyword">of</span> i.cssRules) &#123;</span><br><span class="line">      p.innerHTML += <span class="string">`&lt;code&gt;<span class="subst">$&#123;j.selectorText&#125;</span>&lt;/code&gt;&lt;br&gt;`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>基于给定的样式表，上面将产生： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">body</span><br><span class="line">.component</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Working with the CSSStyleSheet API – Accessing @media Rules" src="//codepen.io/zhehuaxuan/embed/MLpdJz/?height=465&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/MLpdJz/" target="_blank" rel="noopener">Working with the CSSStyleSheet API – Accessing @media Rules</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>正如您所看到的，在我遍历所有规则以查看是否存在<code>@media</code>规则（类型4）之后，我遍历<code>cssRules</code>的每个媒体规则对象（在这种情况下，只有一个）并记录在那个媒体规则里面的每个规则的选择器文本。</p>
<p>因此，<code>@media</code>规则上公开的接口类似于样式表上公开的接口。<code>@media</code>但是，该规则还包含一个<code>conditionText</code>属性，如以下代码段和演示中所示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myRules = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules,</span><br><span class="line">    p = <span class="built_in">document</span>.querySelector(<span class="string">'.output'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">of</span> myRules) &#123;</span><br><span class="line">  <span class="keyword">if</span> (i.type === <span class="number">4</span>) &#123;</span><br><span class="line">    p.innerHTML += <span class="string">`&lt;code&gt;<span class="subst">$&#123;i.conditionText&#125;</span>&lt;/code&gt;&lt;br&gt;`</span>;</span><br><span class="line">    <span class="comment">// (max-width: 800px) </span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Working with the CSSStyleSheet API – Accessing @media Rules" src="//codepen.io/zhehuaxuan/embed/OdmOwd/?height=465&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/OdmOwd/" target="_blank" rel="noopener">Working with the CSSStyleSheet API – Accessing @media Rules</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>此代码循环遍历所有媒体查询规则，并记录确定该规则何时适用的文本（即条件）。还有一个<code>mediaText</code>返回相同值的属性。根据规范，您可以获得或设置其中任何一个。 </p>
<h3 id="使用CSSOM访问-keyframes规则"><a href="#使用CSSOM访问-keyframes规则" class="headerlink" title="#使用CSSOM访问@keyframes规则"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-11" target="_blank" rel="noopener">#</a>使用CSSOM访问@keyframes规则</h3><p>Now that I’ve demonstrated how to read information from a <code>@media</code> rule, let’s consider how to access a <code>@keyframes</code> rule. Here’s some code to get started:</p>
<p>现在我已经演示了如何读取<code>@media</code>规则中的信息，现在让我们考虑如何访问<code>@keyframes</code>规则。我们从下面的代码开始： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myRules = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules,</span><br><span class="line">    p = <span class="built_in">document</span>.querySelector(<span class="string">'.output'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">of</span> myRules) &#123;</span><br><span class="line">  <span class="keyword">if</span> (i.type === <span class="number">7</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (j <span class="keyword">of</span> i.cssRules) &#123;</span><br><span class="line">     p.innerHTML += <span class="string">`&lt;code&gt;<span class="subst">$&#123;j.keyText&#125;</span>&lt;/code&gt;&lt;br&gt;`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Working with the CSSStyleSheet API – Accessing @keyframes Rules" src="//codepen.io/zhehuaxuan/embed/mvmqzz/?height=465&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/mvmqzz/" target="_blank" rel="noopener">Working with the CSSStyleSheet API – Accessing @keyframes Rules</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>在这个例子中，我正在查询类型为7（i.e. <code>@keyframes</code>规则）的规则。当找到一个规则时，遍历所有规则<code>cssRules</code>并记录每个规则的<code>keyText</code>属性。这种情况下的日志将是： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;0%&quot;</span><br><span class="line">&quot;20%&quot;</span><br><span class="line">&quot;100%&quot;</span><br></pre></td></tr></table></figure>
<p>您会注意到我的原始CSS使用<code>from</code>并<code>to</code>作为第一个和最后一个关键帧，但是<code>keyText</code>属性计算这些<code>0%</code>和<code>100%</code>。<code>keyText</code>也可以设置值。在我的示例样式表中，我可以像这样硬编码： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Read the current value (0%)</span></span><br><span class="line"><span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules[<span class="number">6</span>].cssRules[<span class="number">0</span>].keyText;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Change the value to 10%</span></span><br><span class="line"><span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules[<span class="number">6</span>].cssRules[<span class="number">0</span>].keyText = <span class="string">'10%'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Read the new value (10%)</span></span><br><span class="line"><span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules[<span class="number">6</span>].cssRules[<span class="number">0</span>].keyText;</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Working with the CSSStyleSheet API – Setting @keyframes Rules" src="//codepen.io/zhehuaxuan/embed/jdmaRP/?height=465&theme-id=dark&default-tab=js,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/jdmaRP/" target="_blank" rel="noopener">Working with the CSSStyleSheet API – Setting @keyframes Rules</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>使用此功能，我们可以动态更改Web应用程序流中的动画关键帧，也可以响应用户操作。</p>
<p>访问<code>@keyframes</code>规则时可用的另一个属性是<code>name</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myRules = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules,</span><br><span class="line">    p = <span class="built_in">document</span>.querySelector(<span class="string">'.output'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">of</span> myRules) &#123;</span><br><span class="line">  <span class="keyword">if</span> (i.type === <span class="number">7</span>) &#123;</span><br><span class="line">    p.innerHTML += <span class="string">`&lt;code&gt;<span class="subst">$&#123;i.name&#125;</span>&lt;/code&gt;&lt;br&gt;`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Working with the CSSStyleSheet API – Getting the name of a @keyframes rule" src="//codepen.io/zhehuaxuan/embed/JxNOQM/?height=465&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/JxNOQM/" target="_blank" rel="noopener">Working with the CSSStyleSheet API – Getting the name of a @keyframes rule</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>回想一下，在CSS中，<code>@keyframes</code>规则如下所示： </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">keyframes</span> exampleAnimation &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: blue;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  20% &#123;</span><br><span class="line">    <span class="attribute">color</span>: orange;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: green;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因此，<code>name</code>属性允许我读取以<code>@keyframes</code>和自定义名称该规则。<code>animation-name</code>特定元素上启用动画时在属性中使用的名称相同。</p>
<p>我在这里要提到的最后一件事是能够获取单个关键帧内的特定样式。这是一些带有演示的示例代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myRules = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules,</span><br><span class="line">    p = <span class="built_in">document</span>.querySelector(<span class="string">'.output'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">of</span> myRules) &#123;</span><br><span class="line">  <span class="keyword">if</span> (i.type === <span class="number">7</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (j <span class="keyword">of</span> i.cssRules) &#123;</span><br><span class="line">      p.innerHTML += <span class="string">`&lt;code&gt;<span class="subst">$&#123;j.style.color&#125;</span>&lt;/code&gt;&lt;br&gt;`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Working with the CSSStyleSheet API – Accessing Property Values inside @keyframes Rules" src="//codepen.io/zhehuaxuan/embed/WPjdrQ/?height=465&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/WPjdrQ/" target="_blank" rel="noopener">Working with the CSSStyleSheet API – Accessing Property Values inside @keyframes Rules</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>在这个例子中，在我找到<code>@keyframes</code>规则之后，我遍历关键帧中的每个规则（例如“from”规则，“20％”规则等）。然后，在每个规则中，我访问一个单独的<code>style</code>属性。在这种情况下，因为我知道<code>color</code>是为每个定义的唯一属性，我只是注销颜色值。</p>
<p>这个例子的主要内容是使用<code>style</code>属性或对象。之前我展示了如何使用此属性来访问内联样式。但在这种情况下，我使用它来访问单个关键帧内的各个属性。</p>
<p>你可能会看到这是如何开辟一些可能性的。这允许您动态修改单个关键帧的属性，这可能是由于某些用户操作或应用程序或可能是基于Web的游戏中发生的其他事件而发生的。</p>
<h3 id="添加和删除CSS声明"><a href="#添加和删除CSS声明" class="headerlink" title="#添加和删除CSS声明"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-12" target="_blank" rel="noopener">#</a>添加和删除CSS声明</h3><p><code>CSSStyleSheet</code>可以访问两种方法，允许您从样式表中添加或删除整个规则：<code>insertRule()</code>和<code>deleteRule()</code>。让我们看看在示例中，他们两个如何操作样式表： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myStylesheet = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>];</span><br><span class="line"><span class="built_in">console</span>.log(myStylesheet.cssRules.length); <span class="comment">// 8</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.styleSheets[<span class="number">0</span>].insertRule(<span class="string">'article &#123; line-height: 1.5; font-size: 1.5em; &#125;'</span>, myStylesheet.cssRules.length);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules.length); <span class="comment">// 9</span></span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="qgmpay" src="//codepen.io/zhehuaxuan/embed/qgmpay/?height=465&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/qgmpay/" target="_blank" rel="noopener">qgmpay</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>在这种情况下，我正在记录<code>cssRules</code>属性的长度（显示样式表最初有8个规则），然后我使用以下<code>insertRule()</code>方法将以下CSS添加为单独的规则： </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">article</span> &#123;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.5em</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我<code>cssRules</code>再次记录属性的长度以确认添加了规则。</p>
<p>该<code>insertRule()</code>方法将字符串作为第一个参数（这是必需的），包括要插入的完整样式规则（包括选择器，花括号等）。如果您正在插入一个规则，那么完整的规则，包括嵌套在at规则中的各个规则可以包含在此字符串中。</p>
<p>第二个参数是可选的。这是一个整数，表示您希望插入规则的位置或索引。如果未包括，则默认为<code>0</code>（意味着规则将插入规则集合的开头）。如果索引恰好大于规则对象的长度，则会引发错误。</p>
<p>该<code>deleteRule()</code>方法使用起来更简单：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myStylesheet = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>];</span><br><span class="line"><span class="built_in">console</span>.log(myStylesheet.cssRules.length); <span class="comment">// 8</span></span><br><span class="line"></span><br><span class="line">myStylesheet.deleteRule(<span class="number">3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(myStylesheet.cssRules.length); <span class="comment">// 7</span></span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Working with the CSSStyleSheet API – Deleting Rules" src="//codepen.io/zhehuaxuan/embed/WPjdWj/?height=465&theme-id=dark&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true"><br>  See the Pen <a href="https://codepen.io/zhehuaxuan/pen/WPjdWj/" target="_blank" rel="noopener">Working with the CSSStyleSheet API – Deleting Rules</a> by 宣浙华<br>  (<a href="https://codepen.io/zhehuaxuan" target="_blank" rel="noopener">@zhehuaxuan</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.<br></iframe>

<p>在这个例子中，这个方法接受一个参数，该参数表示我要删除的规则的索引。</p>
<p>使用任一方法，由于基于零的索引，作为参数传入的选定索引必须小于<code>cssRules</code>对象的长度，否则将引发错误</p>
<h3 id="重新访问-CSSStyleDeclaration-API"><a href="#重新访问-CSSStyleDeclaration-API" class="headerlink" title="#重新访问 CSSStyleDeclaration API"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-13" target="_blank" rel="noopener">#</a>重新访问 CSSStyleDeclaration API</h3><p>之前我解释了如何访问声明为内联样式的单个属性和值。这是通过<code>element.style</code>，暴露<code>CSSStyleDeclaration</code>接口完成的。</p>
<p><code>CSSStyleDeclaration</code>API，但是，作为<code>CSSStyleSheet</code>API的子集暴露 在一个单独的样式规则。当我向您展示如何访问<code>@keyframes</code>规则内的属性时，我已经提到了这一点。要了解其工作原理，请比较以下两个代码段：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"color: lightblue; width: 100px; font-size: 1.3em !important;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: lightblue;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.3em</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第一个例子是获取内联样式的集合如下所示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">'div'</span>).style</span><br></pre></td></tr></table></figure>
<p><code>CSSStyleDeclaration</code>API，允许我获取<code>element.style.color</code>，<code>element.style.width</code>等属性对象。</p>
<p>但我可以在外部样式表中的单个样式规则上公开完全相同的API。这意味着我将我对<code>style</code>属性的使用与<code>CSSStyleSheet</code>界面结合起来。</p>
<p>因此，上面第二个示例中的CSS使用与内联版本完全相同的样式，可以像这样访问：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules[<span class="number">0</span>].style</span><br></pre></td></tr></table></figure>
<p>这里打开一个外链样式表的一个样式规则的<code>CSSStyleDeclaration</code>对象，如果有对个样式规则，可以使用<code>cssRules[1]</code>, <code>cssRules[2]</code>, <code>cssRules[3]</code>等方式来获取。</p>
<p>因此，在外部样式表中，在类型的单个样式规则内1，我可以访问前面提到的所有方法和属性。这包括s<code>etProperty()，getPropertyValue()，item()，removeProperty()</code>和<code>getPropertyPriority()</code>。除此之外，这些相同的功能可用于@keyframes或@media规则内的单个样式规则。</p>
<p>这是一个代码片段和演示，演示了如何在我们的示例样式表中的单个样式规则上使用这些方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Grab the style rules for the body and main elements</span></span><br><span class="line"><span class="keyword">let</span> myBodyRule = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules[<span class="number">1</span>].style,</span><br><span class="line">    myMainRule = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules[<span class="number">2</span>].style;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set the bg color on the body</span></span><br><span class="line">myBodyRule.setProperty(<span class="string">'background-color'</span>, <span class="string">'peachpuff'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get the font size of the body</span></span><br><span class="line">myBodyRule.getPropertyValue(<span class="string">'font-size'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get the 5th item in the body's style rule</span></span><br><span class="line">myBodyRule.item(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Log the current length of the body style rule (8)</span></span><br><span class="line">myBodyRule.length;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Remove the line height</span></span><br><span class="line">myBodyRule.removeProperty(<span class="string">'line-height'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// log the length again (7)</span></span><br><span class="line">myBodyRule.length;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check priority of font-family (empty string)</span></span><br><span class="line">myBodyRule.getPropertyPriority(<span class="string">'font-family'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check priority of margin in the "main" style rule (!important)</span></span><br><span class="line">myMainRule.getPropertyPriority(<span class="string">'margin'</span>);</span><br></pre></td></tr></table></figure>
<iframe height="465" style="width: 100%;" scrolling="no" title="Working with the style object of an individual style rule in an external Stylesheet" src="//codepen.io/zhehuaxuan/embed/vbmdGL/?height=465&theme-id=dark&default-tab=js,result" frameborder="no" allowtransparency="true" allowfullscreen="true"></iframe>

<h3 id="CSS类型对象模型…未来？"><a href="#CSS类型对象模型…未来？" class="headerlink" title="#CSS类型对象模型…未来？"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-14" target="_blank" rel="noopener">#</a>CSS类型对象模型…未来？</h3><p>After everything I’ve considered in this article, it would seem odd that I’d have to break the news that it’s possible that one day the CSSOM as we know it will be mostly obsolete.</p>
<p>在上面提过的所有内容之后，</p>
<p>我不得不打破这样的消息，即有一天我们所知道的CSSOM很可能已经过时了。</p>
<p>That’s because of something called the <a href="https://drafts.css-houdini.org/css-typed-om/" target="_blank" rel="noopener">CSS Typed OM</a> which is part of <a href="https://drafts.css-houdini.org/" target="_blank" rel="noopener">the Houdini Project</a>. Although some people have noted that the new Typed OM is more verbose compared to the current CSSOM, the benefits, as outlined <a href="https://developers.google.com/web/updates/2018/03/cssom" target="_blank" rel="noopener">in this article by Eric Bidelman</a>, include:</p>
<p>那是因为称为<a href="https://drafts.css-houdini.org/css-typed-om/" target="_blank" rel="noopener">CSS Typed OM</a>的东西，它是<a href="https://drafts.css-houdini.org/" target="_blank" rel="noopener">Houdini项目的</a>一部分。虽然有些人已经注意到新的Typed OM与目前的CSSOM相比更加冗长，但<a href="https://developers.google.com/web/updates/2018/03/cssom" target="_blank" rel="noopener">Eric Bidelman在本文中</a>概述的好处包括： </p>
<ul>
<li>Fewer bugs</li>
<li>Arithmetic operations and unit conversion</li>
<li>Better performance</li>
<li>Error handling</li>
<li>CSS property names are always strings</li>
</ul>
<p>For full details on those features and a glimpse into the syntax, be sure to check out <a href="https://developers.google.com/web/updates/2018/03/cssom" target="_blank" rel="noopener">the full article</a>.</p>
<p>As of this writing, CSS Typed OM is supported only in Chrome. You can see the progress of browser support <a href="https://www.chromestatus.com/feature/5682491075592192" target="_blank" rel="noopener">in this document</a>.</p>
<p>在我在本文中考虑过的所有内容之后，我不得不打破这样的消息，即有一天我们所知道的CSSOM很可能已经过时了。</p>
<p>那是因为称为<a href="https://drafts.css-houdini.org/css-typed-om/" target="_blank" rel="noopener">CSS Typed OM</a>的东西，它是<a href="https://drafts.css-houdini.org/" target="_blank" rel="noopener">Houdini项目的</a>一部分。虽然有些人已经注意到新的Typed OM与目前的CSSOM相比更加冗长，但<a href="https://developers.google.com/web/updates/2018/03/cssom" target="_blank" rel="noopener">Eric Bidelman在本文中</a>概述的好处包括：</p>
<ul>
<li>更少的错误</li>
<li>算术运算和单位转换</li>
<li>更好的性能</li>
<li>错误处理</li>
<li>CSS属性名称始终是字符串</li>
</ul>
<p>有关这些功能的完整详细信息和语法的一瞥，请务必查看<a href="https://developers.google.com/web/updates/2018/03/cssom" target="_blank" rel="noopener">完整的文章</a>。</p>
<p>在撰写本文时，CSS Typed OM仅在Chrome中受支持。您可以<a href="https://www.chromestatus.com/feature/5682491075592192" target="_blank" rel="noopener">在本文档中</a>查看浏览器支持的进度。</p>
<h3 id="最后小结"><a href="#最后小结" class="headerlink" title="#最后小结"></a><a href="https://css-tricks.com/an-introduction-and-guide-to-the-css-object-model-cssom/#article-header-id-15" target="_blank" rel="noopener">#</a>最后小结</h3><p>通过JavaScript操作样式表肯定不是你在每个项目中都要做的事情。使用我在这里介绍的方法和属性实现的一些复杂交互有一些非常具体的用例。</p>
<p>如果您已经构建了某种使用这些API的工具，<a href="https://webtoolsweekly.com/?view=suggest" target="_blank" rel="noopener">我很乐意听到它</a>。我的研究只是触及了可能的表面，但我很想知道在现实世界的例子中如何使用它。</p>
<p>我已将本文中的所有演示文稿<a href="https://codepen.io/collection/DEmrVv/" target="_blank" rel="noopener">放入CodePen集合中</a>，因此您可以根据自己的喜好随意使用它们。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhehuaxuan.github.io/2018/12/26/js/gc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZheHuaXuan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhehua's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/26/js/gc/" itemprop="url">JS的GC整理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-26T16:43:23+08:00">
                2018-12-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JAVASCRIPT/" itemprop="url" rel="index">
                    <span itemprop="name">JAVASCRIPT</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="内存泄露"><a href="#内存泄露" class="headerlink" title="内存泄露"></a>内存泄露</h3><h4 id="什么是内存泄露？"><a href="#什么是内存泄露？" class="headerlink" title="什么是内存泄露？"></a>什么是内存泄露？</h4><p>内存泄露就是应用程序不再需要占用内存的时候，由于某些原因，内存没有被操作系统或可用内存池回收。这句话对于所有需要GC的语言都适用，当然包括JS。</p>
<p>JS的内存回收方法主要就是“标记清除”和“引用计数”。</p>
<h4 id="如何判断内存泄露？"><a href="#如何判断内存泄露？" class="headerlink" title="如何判断内存泄露？"></a>如何判断内存泄露？</h4><p><a href="http://www.ruanyifeng.com/blog/2017/04/memory-leak.html" target="_blank" rel="noopener">经验法</a>则是，如果连续五次垃圾回收之后，内存占用一次比一次大，就有内存泄漏。这就要求实时查看内存占用。</p>
<p>查看内存可以使用chrome浏览器中的开发者工具，Performance页签可以进行内存快照的监控。</p>
<h4 id="内存泄露的一般场景是什么？"><a href="#内存泄露的一般场景是什么？" class="headerlink" title="内存泄露的一般场景是什么？"></a>内存泄露的一般场景是什么？</h4><p>1 意外的全局变量</p>
<p>2 被遗忘的计时器或<strong>回调函数</strong></p>
<p>3 脱离 DOM 的引用</p>
<p>4 <strong>闭包</strong></p>
<h4 id="WeakSet-和-WeakMap"><a href="#WeakSet-和-WeakMap" class="headerlink" title="WeakSet 和 WeakMap"></a>WeakSet 和 WeakMap</h4><p>WeakSet 和 WeakMap就是弱引用，在java中也存在这个概念，就是该数据结构不会影响引用变量的计数次数。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhehuaxuan.github.io/2018/09/10/algo/算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZheHuaXuan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhehua's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/10/algo/算法/" itemprop="url">算法的目标</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-10T21:29:13+08:00">
                2018-09-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>1.对遇到的特殊问题要能够自己设计出算法实现；</p>
<p>2.对于原理公开的知名算法，要能将算法原理翻译成具体的算法代码；</p>
<p>3.对已有具体实现的算法，要能够设计出合适的数学模型，将算法应用到实际问题中；</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhehuaxuan.github.io/2018/07/10/js/difficulty/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZheHuaXuan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhehua's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/10/js/difficulty/" itemprop="url">Javascript原生释疑</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-10T16:43:23+08:00">
                2018-07-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JAVASCRIPT/" itemprop="url" rel="index">
                    <span itemprop="name">JAVASCRIPT</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-ES基础知识"><a href="#1-ES基础知识" class="headerlink" title="1.ES基础知识"></a>1.ES基础知识</h4><ol>
<li><p>JS的基本数据类型</p>
<ul>
<li><p>Boolean</p>
</li>
<li><p>String</p>
</li>
<li><p>Number</p>
</li>
<li><p>Null</p>
</li>
<li><p>Undefined</p>
</li>
<li><p>Symbol(ES6)</p>
<blockquote>
<p>注：原始类型不包含Object</p>
</blockquote>
<p><strong>typeof</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> xxx;</span><br><span class="line"><span class="comment">//返回：undefined boolean number string object function、symbol 只比基本类型多了object和function</span></span><br><span class="line"><span class="comment">//注意点：</span></span><br><span class="line"><span class="comment">//1.typeof null结果是object  </span></span><br><span class="line"><span class="comment">//2.typeof [1, 2]结果是object typeof 没有array类型  引用类型只有function和object</span></span><br><span class="line"><span class="comment">//3.typeof Symbol() 用typeof获取symbol类型的值得到的是symbo</span></span><br></pre></td></tr></table></figure>
<p><strong>instanceof</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxx <span class="keyword">instanceof</span> <span class="built_in">Array</span> <span class="comment">//true or false</span></span><br></pre></td></tr></table></figure>
<p>instanceof和typeof的细节，可以移步<a href="http://localhost:4000/2018/06/06/js/js_pro/" target="_blank" rel="noopener">这里</a></p>
</li>
</ul>
</li>
</ol>
<h4 id="1-offsetWidth、clientWidth、scrollWidth、width的区别"><a href="#1-offsetWidth、clientWidth、scrollWidth、width的区别" class="headerlink" title="1. offsetWidth、clientWidth、scrollWidth、width的区别"></a>1. offsetWidth、clientWidth、scrollWidth、width的区别</h4><table>
<thead>
<tr>
<th>属性值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>offsetWidth</td>
<td>真实的width+padding+border</td>
</tr>
<tr>
<td>clientWidth</td>
<td>真实的width+padding</td>
</tr>
<tr>
<td>style.width</td>
<td>返回DOM真实的width</td>
</tr>
<tr>
<td>scrollWidth</td>
<td>返回元素的宽度（包括元素宽度、内边距和溢出尺寸，不包括边框和外边距），无溢出的情况，与clientWidth相同</td>
</tr>
</tbody>
</table>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhehuaxuan.github.io/2018/07/04/architecture/MVC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZheHuaXuan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhehua's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/04/architecture/MVC/" itemprop="url">MVC,MVP,MVVM的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-04T23:29:23+08:00">
                2018-07-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/架构/" itemprop="url" rel="index">
                    <span itemprop="name">架构</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天看到一篇关于探讨<a href="https://segmentfault.com/a/1190000015310674" target="_blank" rel="noopener">MVC,MVP,MVVM的文章</a>，我觉得讲的还是蛮透彻的，值得收藏，下面是我对它的一些摘抄，和自己的一些小小见解。</p>
<h4 id="前端MVC和后端MVC"><a href="#前端MVC和后端MVC" class="headerlink" title="前端MVC和后端MVC"></a>前端MVC和后端MVC</h4><p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/%E6%9E%B6%E6%9E%84/%E5%89%8D%E7%AB%AFmvc%E5%92%8C%E5%90%8E%E7%AB%AFmvc.jpg?raw=true" alt="前端MVC和后端MVC"> </p>
<blockquote>
<p>该图摘自文章，我觉得很清晰明了，讲清楚了前后端的mvc具体指的什么，不过需要指出的是，后端的MVC中的V目前很少使用了，因为逻辑的复杂性，统一交给前端的MVC去处理，而后端主要使用Model和Controller层，最后以Restful API的形式提供给前端，特别是目前的微服务概念很火，前后分离成为必然。</p>
</blockquote>
<p>注：Restful只是实现的一种形式，当然以nodejs把前端在服务端进行渲染（SSR），能够提高页面的性能，这时后端的V就变得厚重的多了。</p>
<h4 id="前端MVC-MVP和MVVM的区别"><a href="#前端MVC-MVP和MVVM的区别" class="headerlink" title="前端MVC,MVP和MVVM的区别"></a>前端MVC,MVP和MVVM的区别</h4><p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/%E6%9E%B6%E6%9E%84/1530719845811.png?raw=true" alt="前端MVC，MVP和MVVM"></p>
<blockquote>
<p>MVC,MVP,MVVM的区别</p>
</blockquote>
<h5 id="MVC架构"><a href="#MVC架构" class="headerlink" title="MVC架构"></a>MVC架构</h5><p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/%E6%9E%B6%E6%9E%84/mvc.png?raw=true" alt="MVC"></p>
<ul>
<li><code>View</code>，对外暴露函用户事件监听的接口，并监听Model的数据改变事件，依赖于Model</li>
<li><code>Controller</code>，不对外暴露任何接口，监听View的用户事件，并对Model的接口了如指掌，依赖于Model和View </li>
<li><code>Model</code>，对外暴露函数调用接口和事件监听接口，不依赖Controller和View </li>
</ul>
<p>MVC中之间的耦合性相对较高，比如在Controller层直接操纵View层过多，Controller层就变的难为维护了，所以在Model层和View层中定义接口进行交互，便于维护，这一层就是Presenter层，也就是MVP架构。</p>
<h5 id="MVP架构"><a href="#MVP架构" class="headerlink" title="MVP架构"></a>MVP架构</h5><p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/%E6%9E%B6%E6%9E%84/mvp.png?raw=true" alt="MVP"></p>
<ul>
<li><code>Model</code>，对外暴露函数调用接口和事件监听接口，对Presenter和View的存在一无所知，所以不依赖Presenter和View</li>
<li><code>View</code>，对外暴露函数调用接口和事件监听接口，对Presenter和Model的存在一无所知，所以不依赖Presenter和View</li>
<li><code>Presenter</code>，不对外暴露任何接口，监听View和Model的事件，并对它们的接口了如指掌，所以依赖于Model和View</li>
</ul>
<p>一旦接口过多，也是相当复杂，如果Model层中的模型变动，View层能够相应的自动发生变动该多好？所以产生了MVVM。</p>
<h5 id="MVVM架构"><a href="#MVVM架构" class="headerlink" title="MVVM架构"></a>MVVM架构</h5><p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/%E6%9E%B6%E6%9E%84/mvvm.png?raw=true" alt="MVVM架构"> </p>
<ul>
<li><code>Model</code>，对外暴露函数调用接口和事件监听接口，不依赖ViewModel和View</li>
<li><code>ViewModel</code>，监听Model的事件，并对Model的接口了如指掌，依赖于Model。同时向View暴露响应逻辑的调用接口，以及所有的状态数据，并不依赖于View</li>
<li><code>View</code>，监听用户交互事件，然后调用ViewModel的响应逻辑，同时将自己的显示状态与ViewModel的状态数据绑定在一起，所以依赖于ViewModel</li>
</ul>
<p>在其文中举了一个例子相当生动：</p>
<blockquote>
<ol>
<li><p>View获取下拉事件，通知Controller</p>
</li>
<li><p>Controller向后台Model发起请求，请求内容为下拉刷新</p>
</li>
<li><p>Model获得10条新闻数据，传递给Controller</p>
</li>
<li><p>Controller拿到10条新闻数据，可能做一些数据处理，然后拿处理好的数据渲染View    </p>
<p>MVC: 拿到UI节点，渲染10条新闻    </p>
<p>MVP: 通过View提供的接口渲染10条新闻    </p>
<p>MVVM: 无需操作，只要VM的数据变化，通过数据双向绑定，View直接变化</p>
</li>
</ol>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhehuaxuan.github.io/2018/06/29/communication/同步异步阻塞非阻塞/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZheHuaXuan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhehua's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/29/communication/同步异步阻塞非阻塞/" itemprop="url">同步异步，阻塞和非阻塞</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-29T22:31:23+08:00">
                2018-06-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/通信机制/" itemprop="url" rel="index">
                    <span itemprop="name">通信机制</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>同步和异步，阻塞和非阻塞，根据字面意思也能够分出差别，但是<code>同步，异步</code>与<code>阻塞，非阻塞</code>很容易混淆，那么同步是不是就是阻塞，异步是不是就是非阻塞？</p>
<p>答案是否定的，虽然同步意味着阻塞，异步意味着不阻塞，但是面对的对象不同，下面是摘自博客园其中一篇<a href="https://www.cnblogs.com/Anker/p/5965654.html" target="_blank" rel="noopener">博客</a>对同步、异步，阻塞、非阻塞的定义：</p>
<blockquote>
<p>同步、异步：</p>
</blockquote>
<ul>
<li>概念：消息的通知机制</li>
<li>解释：涉及到IO通知机制；所谓同步，就是发起调用后，被调用者处理消息，必须等处理完才直接返回结果，没处理完之前是不返回的，调用者主动等待结果；所谓异步，就是发起调用后，被调用者直接返回，但是并没有返回结果，等处理完消息后，通过状态、通知或者回调函数来通知调用者，调用者被动接收结果。阻塞、非阻塞：</li>
</ul>
<blockquote>
<p>阻塞、非阻塞</p>
</blockquote>
<ul>
<li>概念：程序等待调用结果时的状态</li>
<li>解释：涉及到CPU线程调度；所谓阻塞，就是调用结果返回之前，该执行线程会被挂起，不释放CPU执行权，线程不能做其它事情，只能等待，只有等到调用结果返回了，才能接着往下执行；所谓非阻塞，就是在没有获取调用结果时，不是一直等待，线程可以往下执行，如果是同步的，通过轮询的方式检查有没有调用结果返回，如果是异步的，会通知回调。</li>
</ul>
<p>根据概念，他们讲的就不是同一件事情。</p>
<p>同步和异步是用来形容消息的通知机制，通信机制就是一个Rule，一个规则，同步就是严格按照先后顺序去做事情，比如有时候我们的事情必须一件一件去做，我先开发原型界面，再前后端联调——也就是说我的开发流程这个Rule，我在没有开发完原型界面之前是不会跟后端去联调的，这就是同步；而异步在生活中就很多了，我在家里放了一只老鼠夹，我不可能在旁边看着老鼠上钩，我可以去做其他的事情，直到有一天，老鼠夹发出警报了（这是一个连着app的老鼠夹23333），我发现有老鼠上钩了，这个就是异步。所以它们针对的是Rule，前端开发流程，老鼠夹夹老鼠，这个都是一种Rule，通信机制。</p>
<p>阻塞和非阻塞是用来形容通信一方的状态，比如我打滴滴，师傅接单了，1分钟就到，我站在路边，时刻关注着手机，我的这个状态就是阻塞状态，而如果要10分钟才到，这个时候外面又很热，那我先去买个可乐喝一下，时不时的看一下手机，看看是不是师傅快到了，这个就是非阻塞。</p>
<p>那么为什么会出现阻塞和非阻塞呢？就是因为同步机制造成的，如果是异步，最后事情好了，通知我一声，good！！！我阻塞在那里干嘛，我该干嘛干嘛。但是同步的话我就没办法了，只能等呗，时间少一点无所谓的，那时间一长呢？做点其他的事情呗，时不时的看看后续情况，提高效率。</p>
<p>所以同步都伴随着阻塞和非阻塞，以后再也不要把同步异步，阻塞、非阻塞搞混了。</p>
<p>抛砖引玉，望提出宝贵意见。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhehuaxuan.github.io/2018/06/27/program_person/bad_action/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZheHuaXuan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhehua's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/27/program_person/bad_action/" itemprop="url">勤能补拙</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-27T23:48:10+08:00">
                2018-06-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/工作漫谈/" itemprop="url" rel="index">
                    <span itemprop="name">工作漫谈</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/1530114837431.png?raw=true" alt="1530114837431"></p>
<blockquote>
<p>针对于程序员平时有的坏习惯，包括我也是很多都占了，针对于这些问题进行总结</p>
</blockquote>
<p>克服上述的几个不良习惯，一定会跟别人产生不一样的差距，时刻勉励自己，事在人为。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhehuaxuan.github.io/2018/06/09/css/scroller/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZheHuaXuan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhehua's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/09/css/scroller/" itemprop="url">JavaScript 与 CSS 滚动实现最新指南</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-09T17:29:13+08:00">
                2018-06-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CSS/" itemprop="url" rel="index">
                    <span itemprop="name">CSS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一些（网站）滚动的效果是如此令人着迷但你却不知该如何实现，本文将为你揭开它们的神秘面纱。我们将基于最新的技术与规范为你介绍最新的 JavaScript 与 CSS 特性，（当你付诸实践时）将使你的页面滚动更平滑、美观且性能更好。</p>
<p>大多数的网页的内容都无法在一屏内全部展现，因而（页面）滚动对于用户而言是必不可少的。对于前端工程师与 UX 设计师而言，跨浏览器提供良好的滚动体验，同时符合设计（要求），无疑是一个挑战。尽管 web 标准的发展速度远超从前，但代码的实现往往是落后的。下文将为你介绍一些常见的关于滚动的案例，检查一下你所用的解决方案是否被更优雅的方案所代替。</p>
<h3 id="消逝的滚动条"><a href="#消逝的滚动条" class="headerlink" title="消逝的滚动条"></a>消逝的滚动条</h3><p>在过去的三十年里，滚动条的外观不断改变以符合设计的趋势，设计师们为（滚动条的）颜色、阴影、上下箭头的形状与边框的圆角实验了多种风格。以下是 Windows 上的变化历程：</p>
<p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/CSS/1528535978470.png?raw=true" alt="1528535978470"></p>
<blockquote>
<p>Windows 上的滚动条</p>
</blockquote>
<p>在2011年，苹果设计师从 ios 上获得灵感，为如何定义“美观的”滚动条确定了方向。所有滚动条均从 Mac 电脑中消失，不再占据任何页面空间，只有在用户触发滚动时（滚动条）才会重新出现（有些用户会设置不隐藏滚动条）。</p>
<p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/CSS/1528536021999.png?raw=true" alt="1528536021999"></p>
<blockquote>
<p>Mac 上的滚动条</p>
</blockquote>
<p>滚动条安静地消逝并未引起苹果粉丝的不满，已经习惯了 iPhone 与 iPad 上滚动方式的用户很快地习惯了这一设计。大多数开发人员与设计师都认为这是一个“好消息”，<strong>因为计算滚动条的宽度可真是件苦差事</strong>。</p>
<blockquote>
<p>然而，我们生活在一个拥有众多操作系统与浏览器的世界中，它们（对于滚动）的实现各不相同。如果你和我们一样是一名 Web 开发者，你可不能把“滚动条问题”置之不理。</p>
</blockquote>
<p>以下将为你介绍一些小技巧，使你的用户在滚动时有更好的体验。</p>
<h3 id="隐藏但可滚动"><a href="#隐藏但可滚动" class="headerlink" title="隐藏但可滚动"></a>隐藏但可滚动</h3><p>先来看看一个关于模态框的经典例子。当它被打开的时候，主页面应该停止滚动。在 CSS 中有如下的快捷实现方式：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但上述代码会带来一点不良的副作用：</p>
<p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/CSS/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20180609172103.gif?raw=true" alt="img"> </p>
<blockquote>
<p>注意红色箭头</p>
</blockquote>
<p>在这个示例中，为了演示目的，我们在 Mac 系统中设置了强制显示滚动条，因而用户体验与 Windows 用户相似。</p>
<p>我们该如何解决这个问题呢？如果我们知道滚动条的宽度，每次当模态框出现时，可在主页面的右边设置一点边距。</p>
<p>由于不同的操作系统与浏览器对滚动条的宽度不一，因而获取它的宽度并不容易。在Mac 系统中，无论任何浏览器（滚动条）都是统一15px，然而 Windows 系统可会令开发者发狂：</p>
<p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/CSS/1528536193127.png?raw=true" alt="1528536193127"></p>
<blockquote>
<p>“百花齐放”的宽度</p>
</blockquote>
<p>注意，以上仅是 Windows 系统下基于当前最新版浏览器（测试所得）的结果。以前的（浏览器）版本（宽度）可能有所不同，也没人知道未来（滚动条的宽度）会如何变化。</p>
<p>不同于猜测（滚动条的宽度），你可以通过 JavaScript 计算它的宽度（译者注：实测以下代码仅能测出原始的宽度，通过 CSS 改变了滚动条宽度后，以下代码也无法测出实际宽度）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> outer = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> inner = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line"></span><br><span class="line">outer.style.overflow = <span class="string">'scroll'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(outer);</span><br><span class="line"></span><br><span class="line">outer.appendChild(inner);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> scrollbarWidth = outer.offsetWidth - inner.offsetWidth;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.removeChild(outer);</span><br></pre></td></tr></table></figure>
<p>尽管仅仅七行代码（就能测出滚动条的宽度），但有数行代码是操作 DOM 的。（为性能起见，）如非必要，尽量避免进行 DOM 操作。</p>
<p>解决这个问题的另一个方法是在模态框出现时仍保留滚动条，以下是基于这思路的纯 CSS 实现：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">  <span class="attribute">overflow-y</span>: scroll;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>尽管“模态框抖动”问题解决了，但整体的外观却被一个无法使用的滚动条影响了，这无疑是设计中的硬伤。</p>
<p>在我们看来，更好的解决方案是完全地隐藏滚动条。纯粹用 CSS 也是可以实现的。该方法（达到的效果）和 macOS 的表现并不是完全一致，（当用户）滚动时滚动条仍然是不可见的。滚动条总是处于不可见状态，然而页面是可被滚动的。对于Chrome，Safari 和 Opera 而言，可以使用以下的 CSS：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span><span class="selector-pseudo">::-webkit-scrollbar</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>IE 或 Edge 可用以下代码:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">-ms-overflow-style</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>至于 Firefox，很不幸，没有任何办法隐藏滚动条。</p>
<p>正如你所见，并没有任何银弹。任何解决方案都有它的优点与缺点，应根据你项目的需要选择最合适的。</p>
<h3 id="外观争议"><a href="#外观争议" class="headerlink" title="外观争议"></a>外观争议</h3><p>需要承认的是，滚动条的样子在部分操作系统上并不好看。一些设计师喜欢完全掌控他们（所设计）应用的样式，任何一丝细节也不放过。在 GitHub 上有上百个库借助 JavaScript 取代系统滚动条的默认实现，以达到自定义的效果。</p>
<blockquote>
<p>但如果你想根据现有的浏览器定制一个滚动条呢？（很遗憾，）并没有通用的 API，每个浏览器都有其独特的代码实现。</p>
</blockquote>
<p>尽管5.5版本以后的 IE 浏览器允许你修改滚动条的样式，但它只允许你修改滚动条的颜色。以下是如何重新绘制（滚动条）拖动部分与箭头的代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">scrollbar-face-color</span>: blue;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但只改变颜色对提高用户体验而言帮助不大。据此，WebKit 的开发者在2009年提出了（修改滚动条）样式的方案。以下是使用 <code>-webkit</code> 前缀在支持相关样式的浏览器中模拟 macOS 滚动条样式的代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">::-webkit-scrollbar</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">8px</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">::-webkit-scrollbar-thumb</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#c1c1c1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Chrome、Safari、Opera 甚至于 UC 浏览器或者三星自带的桌面浏览器都支持（上述 CSS）。Edge 也有计划实现它们。但三年过去了，该计划仍在中等优先级中（而尚未被实现）。</p>
<p>当我们讨论滚动条的定制时，Mozilla 基金会基本上是无视了设计师的需求。（有开发者在）17年前就已经提出了一个希望修改滚动条样式的请求。而就在几个月前，Jeff Griffiths（Firefox 浏览器总监）终于为这个问题作出了回答：</p>
<p><strong>除非团队中有人对此有兴趣，否则我对此毫不关心。</strong></p>
<p>公平地说，从 W3C 的角度看来，尽管 WebKit 的实现得到广泛的支持，但它仍然不是标准。现有的为滚动条修改样式的草案，是基于 IE 的：仅能修改它的颜色。</p>
<p>伴随着请求如同 WebKit 一样支持滚动条样式修改 issue 的提交，争议仍在继续。如果你想影响 CSS 工作小组，是时候参与讨论了。也许这不是优先级最高的问题，但（如同 WebKit 一样修改滚动条样式）得到标准化后，能使很多前端工程师与设计师轻松很多。</p>
<h3 id="流畅的操作体验"><a href="#流畅的操作体验" class="headerlink" title="流畅的操作体验"></a>流畅的操作体验</h3><p>对于滚动而言，最常见的任务是登录页的导航（跳转）。通常，它是通过锚点链接来完成的。只需要知道元素的 <code>id</code> 即可：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#section"</span>&gt;</span>Section<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>点击该链接会 跳 到（该锚点对应的）区块上，（然而） UX 设计师一般会坚持认为该过程应是平滑地运动的。GitHub 上有大量造好的轮子（帮你解决这个问题），然而它们或多或少都用到 JavaScript。（其实）只用一行代码也能实现同样的效果，最近DOM API 中的 <code>Element.scrollIntoView()</code> 可以通过传入配置对象来实现平滑滚动：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">elem</span><span class="selector-class">.scrollIntoView</span>(&#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">behavior</span>: <span class="string">'smooth'</span></span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>然而该属性兼容性较差且仍是通过脚本（来控制样式）。如有可能，应尽量少用额外的脚本。</p>
<p>幸运的是，有一个全新的 CSS 属性（仍在工作草案中），可以用简单的一行代码改变整个页面滚动的行为。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">scroll-behavior</span>: smooth;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/JS/640.gif?raw=true" alt="img"></p>
<p>（从一个区块跳到另一个）</p>
<p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/JS/641.gif?raw=true" alt="img"></p>
<p>（平滑地滚动）</p>
<p>你可以在 codepen （链接<a href="https://codepen.io/askd/full/WdXOYW）上试验这个属性。在撰写本文时，`scroll-behavior`" target="_blank" rel="noopener">https://codepen.io/askd/full/WdXOYW）上试验这个属性。在撰写本文时，`scroll-behavior`</a> 仅在 Chrome、 Firefox 与 Opera 上被支持，但我们希望它能被广泛支持，因为使用 CSS （比使用 JavaScript）在解决页面滚动问题时优雅得多，并更符合“渐进增强”的模式。</p>
<h3 id="粘性-CSS"><a href="#粘性-CSS" class="headerlink" title="粘性 CSS"></a>粘性 CSS</h3><p>另一个常见的需求是根据滚动方向动态地定住元素，即有名的“粘性（即 CSS 中的<code>position: sticky</code>）”效应。</p>
<p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/JS/642.gif?raw=true" alt="img"> </p>
<blockquote>
<p>一个粘性元素</p>
</blockquote>
<p>在以前的日子里，要实现一个“粘性”元素需要编写复杂的滚动处理函数去计算元素的大小。（然而）该函数较难处理元素在“黏住”与“不黏住”之间微小的延迟，（通常会）导致（元素）抖动的出现。通过 JavaScript 来实行（“粘性”元素）也有性能上的问题，特别是在（需要）调用 [<code>Element.getBoundingClientRect()</code> ]时(<a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect)。" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect)。</a></p>
<p>不久之前，CSS 实现了 <code>position: sticky</code> 属性。只需通过指定（某方向上的）偏移量即可实现我们想要的效果。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">position</span>: sticky;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50px</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（编写上述代码后）剩下的就交由浏览器实现即可。你可以在 codepen 上试验一下。撰写本文之时，<code>position: sticky</code> 在各式浏览器（包括移动端浏览器）上支持良好，所以如果你还在使用 JavaScript 去解决这个问题的话，是时候换成纯 CSS 的实现了。</p>
<h3 id="全面使用函数节流"><a href="#全面使用函数节流" class="headerlink" title="全面使用函数节流"></a>全面使用函数节流</h3><p>从浏览器的角度看来，滚动是一个<strong>事件</strong>，因此在 JavaScript 中是使用一个标准化的事件监听器 <strong>addEventListener</strong> 去处理它： </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, () =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> scrollTop = <span class="built_in">window</span>.scrollY;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* doSomething with scrollTop */</span></span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>用户往往高频率地滚动（页面），但如果滚动事件触发太频繁的话，会导致性能上的问题，可以通过使用<strong>函数节流</strong>这一技巧去优化它。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, throttle(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> scrollTop = <span class="built_in">window</span>.scrollY;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* doSomething with scrollTop */</span></span><br><span class="line"></span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<p>你需要定义一个节流函数包装原来的事件监听函数，（节流函数是）减少被包装函数的执行次数，只允许它在固定的时间间隔之内执行一次：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">action, wait = <span class="number">1000</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> time = <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((time + wait - <span class="built_in">Date</span>.now()) &lt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">        action();</span><br><span class="line"></span><br><span class="line">        time = <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>为了使（节流后的）滚动更平滑，你可以通过使用<code>window.requestAnimationFrame()</code> 来实现函数节流：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">action</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> isRunning = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isRunning) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    isRunning = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">      action();</span><br><span class="line"></span><br><span class="line">      isRunning = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然，你可以通过现有的开源轮子来实现，就像 Lodash 一样。你可以访问 codepen 来看看上述解决方案与 Lodash 中的 <code>_.throttle</code> 之间的区别。</p>
<p>使用哪个（开源库）并不重要，重要的是在需要的时候，记得优化你（页面中的）滚动处理函数。</p>
<h3 id="在视窗中显示"><a href="#在视窗中显示" class="headerlink" title="在视窗中显示"></a>在视窗中显示</h3><p>当你需要实现图片<strong>懒加载</strong>或者<strong>无限滚动</strong>时，需要确定元素是否出现在视窗中。这可以在事件监听器中处理，最常见的解决方案是使用 <code>lement.getBoundingClientRect()</code> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, () =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> rect = elem.getBoundingClientRect();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> inViewport = rect.bottom &gt; <span class="number">0</span> &amp;&amp; rect.right &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line"></span><br><span class="line">                     rect.left &lt; <span class="built_in">window</span>.innerWidth &amp;&amp;</span><br><span class="line"></span><br><span class="line">                     rect.top &lt; <span class="built_in">window</span>.innerHeight;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>上述代码的问题在于每次调用 <code>getBoundingClientRect</code> 时都会触发<em>回流</em>，严重地影响了性能。在事件处理函数中调用（ <code>getBoundingClientRect</code> ）尤为糟糕，就算使用了函数节流（的技巧）也可能对性能没多大帮助。 （回流是指浏览器为局部或整体地重绘某个元素，需要重新计算该元素在文档中的位置与形状。）</p>
<p>在2016年后，可以通过使用 Intersection Observer 这一 API 来解决问题。它允许你追踪目标元素与其祖先元素或视窗的交叉状态。此外，尽管只有<em>一部分</em>元素出现在视窗中，哪怕只有一像素，也可以选择触发回调函数：</p>
<p>const observer = new IntersectionObserver(callback, options);</p>
<p>observer.observe(element);</p>
<p>（点击<a href="https://gist.github.com/paulirish/5d52fb081b3570c81e3a，查看触发回流的" target="_blank" rel="noopener">https://gist.github.com/paulirish/5d52fb081b3570c81e3a，查看触发回流的</a> DOM 属性和方法。）</p>
<p>此 API 被广泛地支持，但仍有一些浏览器需要 polyfill。尽管如此，它仍是目前最好的解决方案。</p>
<h3 id="滚动边界问题"><a href="#滚动边界问题" class="headerlink" title="滚动边界问题"></a>滚动边界问题</h3><p>如果你的弹框或下拉列表是可滚动的，那你务必要了解<em>连锁滚动</em>相关的问题：当用户滚动到（弹框或下拉列表）末尾（后再继续滚动时），整个页面都会开始滚动。</p>
<p><img src="https://github.com/zhehuaxuan/imageHub/blob/master/JS/643.gif?raw=true" alt="img"> </p>
<blockquote>
<p>连锁滚动的表现</p>
</blockquote>
<p>当滚动元素到达底部时，你可以通过（改变）页面的 <code>overflow</code> 属性或在滚动元素的滚动事件处理函数中取消默认行为来解决这问题。</p>
<p>如果你选择使用 JavaScript （来处理），请记住要处理的不是“scroll（事件）”，而是每当用户使用鼠标滚轮或触摸板时触发的“wheel（事件）”：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleOverscroll</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> delta = -event.deltaY;</span><br><span class="line">  <span class="keyword">if</span> (delta&lt; <span class="number">0</span> &amp;&amp;  elem.scrollHeight - elem.scrollTop) &#123;</span><br><span class="line">    elem.scrollTop = elem.scrollHeight;</span><br><span class="line">    event.preventDefault();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (delta &gt; elem.scrollTop) &#123;</span><br><span class="line">    elem.scrollTop = <span class="number">0</span>;</span><br><span class="line">    event.preventDefault();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不幸的是，这个解决方案不太可靠。同时可能对（页面）性能产生负面影响。</p>
<p>过度滚动对移动端的影响尤为严重。Loren Brichter 在 iOS 的 Tweetie 应用上创造了一个“下拉刷新”的新手势，这在 UX 社区中引起了轰动：包括 Twitter 与 Facebook 在内的各大应用纷纷采用了（相同的手势）。</p>
<p>当这个特性出现在安卓端的 Chrome 浏览器中时，问题出现了：它会刷新整个页面而不是加载更多的内容，成为开发者在他们的应用中实现“下拉刷新”时的麻烦。</p>
<p>CSS 通过 <code>overscroll-behavior</code> 这个新属性解决问题。它通过控制元素滚动到尽头时的行为来解决下拉刷新与连锁滚动所带来的问题，（它的属性值中）也包含针对不同平台特殊值：安卓的 <code>glow</code> 与 苹果系统中的 <code>rubber band</code>。</p>
<p>现在，上面 GIF 中的问题，在 Chrome、Opera 或 Firefox 中可以通过以下一行代码来解决：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">overscroll-behavior</span>: contain;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>公平地说，IE 与 Edge 实现了（它独有的） <code>-ms-scroll-chaining</code> 属性来控制连锁滚动，但它并不能处理所有的情况。幸运的是，根据这消息，微软的浏览器已经准备实现 <code>overscroll-behavior</code> 这一属性了。</p>
<h3 id="触屏之后"><a href="#触屏之后" class="headerlink" title="触屏之后"></a>触屏之后</h3><p>触屏设备上的滚动（体验）是一个很大的话题，深入讨论需要另开一篇文章。然而，由于很多开发者忽略了这方面的内容，这里需要提及一下。</p>
<p>（滚动手势无处不在，令人沉迷，以至于想出了如此疯狂的主意去解决“滚动上瘾”的问题。）</p>
<p>周围的人在智能手机屏幕上上下移动他们的手指的频率是多少呢？经常这样对吧，当你阅读本文时，你很可能就在这么做。</p>
<blockquote>
<p>当你的手指在屏幕上移动时，你期待的是：页面内容平滑且流畅地移动。</p>
</blockquote>
<p>苹果公司开创了“惯性”滚动并拥有它的专利 。它讯速地成为了用户交互的标准并且我们对此已习以为常。</p>
<p>但你也许已经注意到了，尽管移动端系统会为你实现页面上的惯性滚动，但当<em>页面内某个元素</em>发生滚动时，即使用户同样期待惯性滚动，但它并不会出现，这令人沮丧。</p>
<p>这里有一个 CSS 的解决方案，但看起来更像是个 hack：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">-webkit-overflow-scrolling</span>: touch;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>为什么这是个 hack 呢？首先，它只能在支持（webkit）前缀的浏览器上才能工作。其次，它只适用于触屏设备。最后，如果浏览器不支持的话，你就这样置之不理吗？但无论如何，这总归是一个解决方案，你可以试着使用它。</p>
<p>在触屏设备上，另一个需要考虑的问题是开发者如何处理 <code>touchstart</code>与 <code>touchmove</code>事件触发时可能存在的性能问题，它对用户滚动体验的影响非常大。这里详细描述了整个问题。简单来说，现代的浏览器虽然知道如何使得滚动变得平滑，但为确认（滚动）事件处理函数中是否执行了<code>Event.preventDefault()</code>以取消默认行为，有时仍可能需要花费500毫秒来等待事件处理函数执行完毕。</p>
<p>即使是一个空的事件监听器，从不取消任何行为，鉴于浏览器仍会期待<code>preventDefault</code>的调用，也会对性能造成负面影响。</p>
<p>为了准确地告诉浏览器不必担心（事件处理函数中）取消了默认行为，在 WHATWG 的 DOM 标准中存在着一个不太显眼的特性（能解决这问题）。（它就是）Passive event listeners，浏览器对它的支持还是不错的。事件监听函数新接受一个可选的对象作为参数，告诉浏览器当事件触发时，事件处理函数永远不会取消默认行为。（当然，添加此参数后，）在事件处理函数中调用 <code>preventDefault</code> 将不再产生效果。</p>
<p>element.addEventListener(‘touchstart’, e =&gt; {</p>
<p>  /<em> doSomething </em>/</p>
<p>}, { passive: true });</p>
<p>针对不支持该参数的浏览器，这里也有一个 polyfill 。这视频清晰地展示了此改进带来的影响。</p>
<h3 id="旧技术运行良好，为何还要改动？"><a href="#旧技术运行良好，为何还要改动？" class="headerlink" title="旧技术运行良好，为何还要改动？"></a>旧技术运行良好，为何还要改动？</h3><p>在现代互联网中，过渡地依赖 JavaScript 在各浏览器上实现相同的交互效果不再是合理的，“跨浏览器兼容性”已经成为过去式，更多的 CSS 属性与 DOM API 方法正逐步被各大浏览器所支持。</p>
<p>在我们看来，当你的项目中，有特别酷炫的滚动效果时，渐进增强是最好的做法。</p>
<blockquote>
<p>你应该提供（给用户）所有（你能提供的）基础用户体验，并逐步在更先进的浏览器上提供更好的体验。</p>
</blockquote>
<p>必要时使用 polyfill，它们不会产生（不必要的）依赖，一旦（某个 polyfill 所支持的属性）得到广泛地支持，你就可以轻松地将它删掉。</p>
<p>六个月之前，在本文尚未成文之时，之前我们描述的属性只被少量的浏览器所支持。而到了本文发表之时，这些属性已被广泛地支持。</p>
<p>也许到了现在，当你上下翻阅本文之时，（之前不支持某些属性的）浏览器已经支持了该属性，这使得你编程更容易，并使你的应用打包出来体积更小。</p>
<p>感谢阅读至此！查阅浏览器的更新日志，积极参与讨论，有助于 web 标准驶向正确的方向。祝大家一帆风顺，顺利滑（滚）向未来！</p>
<p>本文转自如下：</p>
<p>原文作者：Evil Martians       译者：sea_ljf</p>
<p>文章出处：众成翻译</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhehuaxuan.github.io/2018/06/09/vue/Vue_cycle_life/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZheHuaXuan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhehua's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/09/vue/Vue_cycle_life/" itemprop="url">Vue的生命周期</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-09T15:59:23+08:00">
                2018-06-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index">
                    <span itemprop="name">Vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhehuaxuan.github.io/2018/06/07/lintcode/p_2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZheHuaXuan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zhehua's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/07/lintcode/p_2/" itemprop="url">Merge Two Sorted Arrays</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-07T23:43:23+08:00">
                2018-06-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algothrim-LintCode/" itemprop="url" rel="index">
                    <span itemprop="name">Algothrim-LintCode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Merge-Two-Sorted-Arrays"><a href="#Merge-Two-Sorted-Arrays" class="headerlink" title="Merge Two Sorted Arrays"></a>Merge Two Sorted Arrays</h3><p>Merge two given sorted integer array <em>A</em> and <em>B</em> into a new sorted integer array.</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>A=<code>[1,2,3,4]</code></p>
<p>B=<code>[2,4,5,6]</code></p>
<p>return <code>[1,2,2,3,4,4,5,6]</code></p>
<h3 id="Challenge"><a href="#Challenge" class="headerlink" title="Challenge"></a>Challenge</h3><p>How can you optimize your algorithm if one array is very large and the other is very small?</p>
<p><strong>Answer</strong></p>
<ol>
<li>先合并，在排序</li>
</ol>
<ol>
<li><code>one array is very large and the other is very small?</code>说明两个数很有可能最后pk只剩下大数组，那么就将剩余的大数组直接复制即可</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.gif"
                alt="ZheHuaXuan" />
            
              <p class="site-author-name" itemprop="name">ZheHuaXuan</p>
              <p class="site-description motion-element" itemprop="description">知足.感恩.幸运</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">25</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">39</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/zhehuaxuan" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:xuanzhehua@huawei.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZheHuaXuan</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 个人专属</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
